= Multi Thread Http Server - Step2

* Multi Thread 기반의 Simple Http Server 구현


== Single Thread Http Server 정리

* Single Thread는 하나의 요청을 하나의 Thread가 처리 합니다.
* 시간이 오래걸리는 요청이 있다면 해당 요청을 처리하고 다음 요청을 처리함으로 해당 요청이 처리될 때 까지 다른 요청이 처리되기 까지 Delay가 발생 합니다.
* 동시에 여러 요청을 처리하려면(원할하게 요청을 처리하려면) Multi Thread를 사용해야 합니다.

== Thread 생성

* implements Runnable

* extends Thread

== 실습

* Main.java

[source, java]
----
public static void main( String[] args ) throws IOException {
    try(ServerSocket serverSocket = new ServerSocket(8080);){
        while(true){
            Socket client = serverSocket.accept();
            Thread thread = new Thread(new HttpRequestHandler(client));
            thread.start();
        }
    }
}
----

* HttpRequestHandler.java 구현


== Test
* ab test
* -n 100 > -n 1000 > -n 10000 순서로 진행 합니다.

[source,shell]
----
ab -n 100 http://localhost:8080/
----

== 성능 이슈
* Thread는 무한대로 생성이 되나요?
* 동시에 요청이 10만번이 발생한다면 Thread는 10만개를 생성해야 할 까요?
* 하나의 요청을 하나의 Thread가 처리 할 수 있는 효율적인 방법은 없을까요?

== Reference

* https://docs.oracle.com/en%2Fjava%2Fjavase%2F11%2Fdocs%2Fapi%2F%2F/java.base/java/lang/Runnable.html[java - Runnable]

* https://docs.oracle.com/en%2Fjava%2Fjavase%2F11%2Fdocs%2Fapi%2F%2F/java.base/java/lang/Thread.html[java - Thread]


